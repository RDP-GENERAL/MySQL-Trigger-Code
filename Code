ALL TRIGGER

create database MYSQL_TRIGGER;
USE MYSQL_TRIGGER;
SHOW DATABASES;
SHOW TABLES;

CREATE TABLE EMPLOYEES(
EMPLOYEE_ID INT PRIMARY KEY,
EMPLOYEE_NAME VARCHAR(50),
DEPARTMENT VARCHAR(50),
SALARY DECIMAL(10,2)
);
INSERT INTO EMPLOYEES(EMPLOYEE_ID,EMPLOYEE_NAME,DEPARTMENT,SALARY)VALUES
(1,"JOHN DOE","HR",55000.00),
(2,"JANE SMITH","FINANCE",60000.00),
(3,"BOB JOHNSON","IT",65000.00),
(4,"DAVID","FINANCE",35000.00),
(5,"DONALD","IT",27000.00);

SELECT *FROM EMPLOYEES;

CREATE TABLE AUDIT_LOG(
EMPLOYEE_ID INT PRIMARY KEY,
EMPLOYEE_NAME VARCHAR(50),
EVENT_TIME DATETIME,
EVENT VARCHAR(50));

SELECT * FROM AUDIT_LOG;

DELIMITER //

CREATE TRIGGER AFTER_EMPLOYEE_INSERT
AFTER INSERT
ON EMPLOYEES
FOR EACH ROW
BEGIN
    INSERT INTO AUDIT_LOG(EVENT, EVENT_TIME, EMPLOYEE_ID, EMPLOYEE_NAME)
    VALUES('EMPLOYEE INSERTED', NOW(), NEW.EMPLOYEE_ID, NEW.EMPLOYEE_NAME);
END;
//

INSERT INTO employees(EMPLOYEE_ID,EMPLOYEE_NAME, DEPARTMENT,SALARY) VALUES
(6,'SUROJ DESHPANDEY','HR',78000.00);
INSERT INTO employees(EMPLOYEE_ID,EMPLOYEE_NAME, DEPARTMENT,SALARY) VALUES
(7,'MINAKSHI DIXIT','FINANACE',58000.00);
INSERT INTO employees(EMPLOYEE_ID,EMPLOYEE_NAME, DEPARTMENT,SALARY) VALUES
(8,'NILANJAN SEN','MARKETTING',38000.00);
INSERT INTO employees(EMPLOYEE_ID,EMPLOYEE_NAME, DEPARTMENT,SALARY) VALUES
(9,'PIYUSH  DEV','HR',95000.00);

SELECT * FROM EMPLOYEES;

SELECT * FROM AUDIT_LOG;

									UPDATE TRIGGER

SELECT * FROM EMPLOYEES;


create table EMPLOYEE_AUDIT(
EMPLOYEE_ID INT PRIMARY KEY,
OLD_SALARY DECIMAL(10,2),
NEW_SALARY DECIMAL(10,2),
CHANGED_AT DATETIME);

SELECT * FROM EMPLOYEE_AUDIT;

DELIMITER //

CREATE TRIGGER LOG_SALARY_UPDATE
AFTER UPDATE 
ON EMPLOYEES 
FOR EACH ROW
BEGIN
INSERT INTO EMPLOYEE_AUDIT(EMPLOYEE_ID, OLD_SALARY, NEW_SALARY, CHANGED_AT)
VALUES(OLD.EMPLOYEE_ID, OLD.SALARY, NEW.SALARY, NOW());
END;
//

UPDATE EMPLOYEES 
SET SALARY = 65000.00
WHERE employee_id=1;

select * from employees; 

select * from EMPLOYEE_AUDIT;

										DELETE TRIGGER


SELECT * FROM EMPLOYEES;

CREATE TABLE DEL_EMPLOYEE(
EMPLOYEE_ID INT PRIMARY KEY,
EMPLOYEE_NAME VARCHAR(50),
DEPARTMENT VARCHAR(20),
DELETED_AT DATETIME);

SELECT * FROM DEL_EMPLOYEE;

DELIMITER //
CREATE TRIGGER BEFORE_TRIG_DEL
BEFORE DELETE
ON EMPLOYEES
FOR EACH ROW
BEGIN
INSERT INTO DEL_EMPLOYEE(EMPLOYEE_ID, EMPLOYEE_NAME, DEPARTMENT,DELETED_AT)
VALUES(OLD.EMPLOYEE_ID, OLD.EMPLOYEE_NAME,OLD.DEPARTMENT,NOW());
END;
//

SELECT * FROM DEL_EMPLOYEE;

SELECT * FROM EMPLOYEES;
